このデモでは、事前にトレーニングされたモデルを使用して、画像とテキストプロンプトに基づいてPythonコードを生成する方法を紹介します。

[サンプルコード](../../../../code/06.E2E/E2E_OpenVino_Phi3-vision.ipynb)

以下はステップごとの説明です：

1. **インポートとセットアップ**：
   - 必要なライブラリとモジュールをインポートします。`requests`、画像処理用の`PIL`、モデルと処理を扱うための`transformers`が含まれます。

2. **画像の読み込みと表示**：
   - `PIL`ライブラリを使用して画像ファイル（`demo.png`）を開き、表示します。

3. **プロンプトの定義**：
   - 画像と、その画像を処理して`plt`（matplotlib）を使用して保存するPythonコードを生成するリクエストを含むメッセージを作成します。

4. **プロセッサの読み込み**：
   - `out_dir`ディレクトリで指定された事前にトレーニングされたモデルから`AutoProcessor`を読み込みます。このプロセッサはテキストと画像の入力を処理します。

5. **プロンプトの作成**：
   - `apply_chat_template`メソッドを使用して、メッセージをモデルに適したプロンプトにフォーマットします。

6. **入力の処理**：
   - プロンプトと画像をモデルが理解できるテンソルに処理します。

7. **生成引数の設定**：
   - モデルの生成プロセスの引数を定義します。新しいトークンの最大数や出力をサンプリングするかどうかが含まれます。

8. **コードの生成**：
   - モデルが入力と生成引数に基づいてPythonコードを生成します。`TextStreamer`を使用して出力を処理し、プロンプトと特別なトークンをスキップします。

9. **出力**：
   - 生成されたコードが出力されます。これには、プロンプトで指定されたように画像を処理して保存するPythonコードが含まれます。

このデモは、OpenVinoを使用して、ユーザーの入力と画像に基づいて動的にコードを生成するために事前にトレーニングされたモデルを活用する方法を示しています。

免責事項: この翻訳はAIモデルによって原文から翻訳されたものであり、完全ではない可能性があります。 出力を確認し、必要な修正を行ってください。