このデモでは、事前学習済みモデルを使用して、画像とテキストプロンプトに基づいてPythonコードを生成する方法を紹介します。

[サンプルコード](../../../../code/06.E2E/E2E_OpenVino_Phi3-vision.ipynb)

以下はステップバイステップの説明です：

1. **インポートとセットアップ**:
   - 必要なライブラリとモジュールをインポートします。これには、画像処理のための`requests`、`PIL`や、モデルと処理を扱うための`transformers`が含まれます。

2. **画像の読み込みと表示**:
   - 画像ファイル (`demo.png`) を`PIL`ライブラリを使用して開き、表示します。

3. **プロンプトの定義**:
   - 画像を含むメッセージを作成し、`plt` (matplotlib) を使用して画像を処理し保存するようにリクエストします。

4. **プロセッサの読み込み**:
   - 事前学習済みモデルから`AutoProcessor`を`out_dir`ディレクトリに指定して読み込みます。このプロセッサはテキストと画像の入力を処理します。

5. **プロンプトの作成**:
   - `apply_chat_template`メソッドを使用して、メッセージをモデルに適したプロンプトにフォーマットします。

6. **入力の処理**:
   - プロンプトと画像をモデルが理解できるテンソルに処理します。

7. **生成引数の設定**:
   - モデルの生成プロセスの引数を定義します。これには、新しいトークンの最大数や出力をサンプルするかどうかが含まれます。

8. **コードの生成**:
   - モデルが入力と生成引数に基づいてPythonコードを生成します。`TextStreamer`を使用して、プロンプトと特殊トークンをスキップして出力を処理します。

9. **出力**:
   - 生成されたコードを表示します。これには、プロンプトで指定された通りに画像を処理して保存するPythonコードが含まれます。

このデモは、OpenVinoを使用して事前学習済みモデルを活用し、ユーザーの入力と画像に基づいて動的にコードを生成する方法を示しています。

**免責事項**:
この文書は機械翻訳AIサービスを使用して翻訳されています。正確性を期すために努めておりますが、自動翻訳には誤りや不正確さが含まれる可能性があります。元の言語の文書を権威ある情報源として考慮してください。重要な情報については、専門の人間による翻訳を推奨します。本翻訳の使用に起因する誤解や誤った解釈について、当社は一切の責任を負いません。