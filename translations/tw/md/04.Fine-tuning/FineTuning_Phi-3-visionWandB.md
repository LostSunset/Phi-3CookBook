# Phi-3-Vision-128K-Instruct 專案概述

## 模型

Phi-3-Vision-128K-Instruct 是這個專案的核心，它是一個輕量級、最先進的多模態模型。這個模型屬於 Phi-3 模型家族的一部分，支持最多 128,000 個 token 的上下文長度。模型訓練使用了多樣化的數據集，包括合成數據和經過精心篩選的公開網站，重點強調高質量和需要深度推理的內容。訓練過程包括監督微調和直接偏好優化，以確保精確遵循指示，以及強大的安全措施。

## 創建樣本數據至關重要的幾個原因：

1. **測試**：樣本數據允許你在不同情景下測試應用程序而不影響真實數據。這在開發和預發布階段尤為重要。

2. **性能調優**：有了模仿真實數據規模和複雜度的樣本數據，你可以識別性能瓶頸並相應地優化應用程序。

3. **原型設計**：樣本數據可以用來創建原型和模型，有助於理解用戶需求並獲得反饋。

4. **數據分析**：在數據科學中，樣本數據經常用於探索性數據分析、模型訓練和算法測試。

5. **安全性**：在開發和測試環境中使用樣本數據可以幫助防止敏感真實數據的意外洩露。

6. **學習**：如果你在學習新技術或工具，使用樣本數據可以提供一種實踐應用所學知識的方式。

記住，樣本數據的質量對這些活動有重大影響。它應該在結構和變異性方面盡可能接近真實數據。

### 創建樣本數據
[生成數據集腳本](./CreatingSampleData.md)

## 數據集

一個很好的樣本數據集例子是 [DBQ/Burberry.Product.prices.United.States 數據集](https://huggingface.co/datasets/DBQ/Burberry.Product.prices.United.States)（可在 Huggingface 上獲得）。
Burberry 產品的樣本數據集，包括產品類別、價格和標題的元數據，共有 3,040 行，每行代表一個獨特的產品。這個數據集讓我們可以測試模型理解和解釋視覺數據的能力，生成捕捉精細視覺細節和品牌特徵的描述性文本。

**注意：** 你可以使用任何包含圖像的數據集。

## 複雜推理

模型需要僅根據圖像來推理價格和命名。這要求模型不僅要識別視覺特徵，還要理解這些特徵在產品價值和品牌方面的含義。通過從圖像中合成準確的文本描述，該專案突顯了整合視覺數據以增強模型在現實應用中性能和多功能性的潛力。

## Phi-3 Vision 架構

模型架構是 Phi-3 的多模態版本。它處理文本和圖像數據，將這些輸入整合為一個統一的序列以進行全面的理解和生成任務。模型對文本和圖像使用不同的嵌入層。文本 token 轉換為密集向量，而圖像通過 CLIP 視覺模型處理以提取特徵嵌入。這些圖像嵌入隨後投影以匹配文本嵌入的維度，確保它們可以無縫整合。

## 文本和圖像嵌入的整合

文本序列中的特殊 token 指示應插入圖像嵌入的位置。在處理過程中，這些特殊 token 被相應的圖像嵌入替換，允許模型將文本和圖像作為一個序列來處理。我們的數據集提示使用特殊的 <|image|> token，格式如下：

```python
text = f"<|user|>\n<|image_1|>What is shown in this image?<|end|><|assistant|>\nProduct: {row['title']}, Category: {row['category3_code']}, Full Price: {row['full_price']}<|end|>"
```

## 範例代碼
- [Phi-3-Vision 訓練腳本](../../../../code/04.Finetuning/Phi-3-vision-Trainingscript.py)
- [Weights and Bias 範例演練](https://wandb.ai/byyoung3/mlnews3/reports/How-to-fine-tune-Phi-3-vision-on-a-custom-dataset--Vmlldzo4MTEzMTg3)

**免責聲明**：
本文件使用機器翻譯服務進行翻譯。儘管我們努力確保準確性，但請注意，自動翻譯可能包含錯誤或不準確之處。應以原文文件為權威來源。對於關鍵信息，建議尋求專業人工翻譯。我們對因使用本翻譯而產生的任何誤解或誤讀不承擔責任。