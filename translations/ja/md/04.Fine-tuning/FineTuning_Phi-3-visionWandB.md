# Phi-3-Vision-128K-Instruct プロジェクト概要

## モデル

Phi-3-Vision-128K-Instructは、このプロジェクトの中核となる軽量で最先端のマルチモーダルモデルです。Phi-3モデルファミリーの一部であり、最大128,000トークンのコンテキスト長をサポートします。このモデルは、合成データと慎重にフィルタリングされた公開ウェブサイトを含む多様なデータセットでトレーニングされており、高品質で推論に重点を置いたコンテンツを強調しています。トレーニングプロセスには、指示に正確に従うための監督された微調整と直接的な好みの最適化、および堅牢な安全対策が含まれています。

## サンプルデータ作成が重要な理由

1. **テスト**: サンプルデータを使用すると、実データに影響を与えることなく、さまざまなシナリオでアプリケーションをテストできます。これは特に開発およびステージングフェーズで重要です。

2. **パフォーマンスチューニング**: 実データの規模と複雑さを模倣したサンプルデータを使用することで、パフォーマンスのボトルネックを特定し、アプリケーションを最適化できます。

3. **プロトタイピング**: サンプルデータは、プロトタイプやモックアップの作成に使用でき、ユーザーの要件を理解し、フィードバックを得るのに役立ちます。

4. **データ分析**: データサイエンスでは、サンプルデータは探索的データ分析、モデルトレーニング、アルゴリズムテストによく使用されます。

5. **セキュリティ**: 開発およびテスト環境でサンプルデータを使用することで、実データの機密情報の漏洩を防ぐことができます。

6. **学習**: 新しい技術やツールを学ぶ場合、サンプルデータを使用することで、学んだことを実践的に適用できます。

サンプルデータの品質は、これらの活動に大きな影響を与える可能性があります。構造と変動性において、実データにできるだけ近づけるべきです。

### サンプルデータ作成
[データセット生成スクリプト](./CreatingSampleData.md)

## データセット

サンプルデータセットの良い例は、[DBQ/Burberry.Product.prices.United.States dataset](https://huggingface.co/datasets/DBQ/Burberry.Product.prices.United.States) (Huggingfaceで利用可能)です。Burberry製品のサンプルデータセットには、製品カテゴリ、価格、タイトルに関するメタデータが含まれており、合計3,040行があり、各行は一意の製品を表しています。このデータセットを使用すると、モデルが視覚データを理解し解釈する能力をテストし、詳細な視覚的特徴やブランド固有の特徴を捉えた説明文を生成できます。

**Note:** 画像を含む任意のデータセットを使用できます。

## 複雑な推論

モデルは、画像のみから価格や名称について推論する必要があります。これには、視覚的特徴を認識するだけでなく、それらの特徴が製品の価値やブランドにどのような影響を与えるかを理解することが求められます。画像から正確なテキスト記述を生成することで、視覚データを統合してモデルの性能と多様性を現実世界のアプリケーションで向上させる可能性を示します。

## Phi-3 Vision アーキテクチャ

このモデルのアーキテクチャはPhi-3のマルチモーダルバージョンです。テキストと画像データの両方を処理し、これらの入力を統一されたシーケンスに統合して包括的な理解と生成タスクを行います。モデルは、テキストと画像のための別々の埋め込み層を使用します。テキストトークンは密ベクトルに変換され、画像はCLIPビジョンモデルを通じて特徴埋め込みを抽出します。これらの画像埋め込みはテキスト埋め込みの次元に一致するように投影され、シームレスに統合できるようにします。

## テキストと画像の埋め込みの統合

テキストシーケンス内の特別なトークンは、画像埋め込みを挿入する場所を示します。処理中に、これらの特別なトークンは対応する画像埋め込みに置き換えられ、モデルがテキストと画像を単一のシーケンスとして処理できるようにします。データセットのプロンプトは、特別な<|image|>トークンを使用して次のようにフォーマットされます。

```python
text = f"<|user|>\n<|image_1|>What is shown in this image?<|end|><|assistant|>\nProduct: {row['title']}, Category: {row['category3_code']}, Full Price: {row['full_price']}<|end|>"
```

## サンプルコード
- [Phi-3-Vision トレーニングスクリプト](../../../../code/04.Finetuning/Phi-3-vision-Trainingscript.py)
- [Weights and Bias Example walkthrough](https://wandb.ai/byyoung3/mlnews3/reports/How-to-fine-tune-Phi-3-vision-on-a-custom-dataset--Vmlldzo4MTEzMTg3)

**免責事項**：
この文書は機械翻訳AIサービスを使用して翻訳されています。正確さを期すよう努めておりますが、自動翻訳には誤りや不正確さが含まれる可能性があることをご了承ください。原文が信頼できる情報源と見なされるべきです。重要な情報については、専門の人間による翻訳をお勧めします。この翻訳の使用に起因する誤解や誤解について、当社は一切の責任を負いません。