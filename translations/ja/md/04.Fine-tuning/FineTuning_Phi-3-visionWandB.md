# Phi-3-Vision-128K-Instruct プロジェクト概要

## モデルについて

Phi-3-Vision-128K-Instruct は、軽量で最先端のマルチモーダルモデルであり、このプロジェクトの中心です。Phi-3 モデルファミリーの一部で、最大 128,000 トークンのコンテキスト長をサポートします。モデルは、合成データや厳選された公開ウェブサイトを含む多様なデータセットで訓練されており、高品質で推論集約的なコンテンツを重視しています。訓練プロセスには、指示に正確に従うための監督付き微調整と直接的な好みの最適化が含まれており、堅牢な安全対策も講じられています。

## サンプルデータ作成の重要性

1. **テスト**: サンプルデータを使用することで、実データに影響を与えることなく、さまざまなシナリオでアプリケーションをテストできます。これは特に開発段階やステージング段階で重要です。

2. **パフォーマンスチューニング**: 実データの規模や複雑さに似たサンプルデータを使用することで、パフォーマンスのボトルネックを特定し、アプリケーションを最適化できます。

3. **プロトタイピング**: サンプルデータはプロトタイプやモックアップの作成に利用でき、ユーザーの要求を理解しフィードバックを得るのに役立ちます。

4. **データ分析**: データサイエンスにおいて、サンプルデータは探索的データ分析、モデル訓練、アルゴリズムテストによく使用されます。

5. **セキュリティ**: 開発やテスト環境でサンプルデータを使用することで、機密性の高い実データの漏洩を防ぐことができます。

6. **学習**: 新しい技術やツールを学ぶ際に、サンプルデータを使うことで学んだことを実践的に応用できます。

サンプルデータの品質はこれらの活動に大きな影響を与えることを覚えておいてください。構造や変動性において実データにできるだけ近いものにするべきです。

### サンプルデータの作成
[Generate DataSet Script](./CreatingSampleData.md)

## データセット

良いサンプルデータセットの例として、[DBQ/Burberry.Product.prices.United.States dataset](https://huggingface.co/datasets/DBQ/Burberry.Product.prices.United.States)（Huggingface で利用可能）があります。Burberry 製品のサンプルデータセットで、製品のカテゴリ、価格、タイトルに関するメタデータを含む合計 3,040 行があり、それぞれが一意の製品を表しています。このデータセットは、モデルが視覚データを理解し解釈する能力をテストし、複雑な視覚的詳細やブランド固有の特徴を捉える記述文を生成するのに役立ちます。

**Note:** 画像を含む任意のデータセットを使用できます。

## 複雑な推論

モデルは、画像のみを与えられた場合の価格や名前について推論する必要があります。これには、視覚的な特徴を認識するだけでなく、それらの特徴が製品の価値やブランディングに与える影響を理解することが求められます。画像から正確なテキスト記述を生成することで、視覚データを統合してモデルの性能と多様性を向上させる可能性を示しています。

## Phi-3 Vision アーキテクチャ

モデルのアーキテクチャは Phi-3 のマルチモーダルバージョンです。テキストデータと画像データの両方を処理し、これらの入力を統合されたシーケンスに変換して包括的な理解と生成タスクを行います。モデルはテキストと画像のために別々の埋め込み層を使用します。テキストトークンは高密度ベクトルに変換され、画像は CLIP ビジョンモデルを通じて特徴埋め込みを抽出します。これらの画像埋め込みはテキスト埋め込みの次元に一致するようにプロジェクトされ、シームレスに統合できるようにします。

## テキストと画像の埋め込みの統合

テキストシーケンス内の特別なトークンが、画像埋め込みを挿入する場所を示します。処理中に、これらの特別なトークンは対応する画像埋め込みに置き換えられ、モデルがテキストと画像を単一のシーケンスとして扱えるようにします。データセットのプロンプトは、以下のように特別な <|image|> トークンを使用してフォーマットされます：

```python
text = f"<|user|>\n<|image_1|>What is shown in this image?<|end|><|assistant|>\nProduct: {row['title']}, Category: {row['category3_code']}, Full Price: {row['full_price']}<|end|>"
```

## サンプルコード
- [Phi-3-Vision Training Script](../../../../code/04.Finetuning/Phi-3-vision-Trainingscript.py)
- [Weights and Bias Example walkthrough](https://wandb.ai/byyoung3/mlnews3/reports/How-to-fine-tune-Phi-3-vision-on-a-custom-dataset--Vmlldzo4MTEzMTg3)

免責事項: この翻訳はAIモデルによって原文から翻訳されたものであり、完璧ではない可能性があります。 出力を確認し、必要に応じて修正を行ってください。