이 데모는 사전 학습된 모델을 사용하여 이미지와 텍스트 프롬프트를 기반으로 Python 코드를 생성하는 방법을 보여줍니다.

[Sample Code](../../../../code/06.E2E/E2E_OpenVino_Phi3-vision.ipynb)

다음은 단계별 설명입니다:

1. **임포트 및 설정**:
   - 필요한 라이브러리와 모듈을 임포트합니다. 여기에는 `requests`, 이미지 처리를 위한 `PIL`, 모델 및 처리를 다루는 `transformers`가 포함됩니다.

2. **이미지 로드 및 표시**:
   - `PIL` 라이브러리를 사용하여 이미지 파일(`demo.png`)을 열고 표시합니다.

3. **프롬프트 정의**:
   - 이미지와 `plt` (matplotlib)를 사용하여 이미지를 처리하고 저장하는 Python 코드를 생성해 달라는 요청을 포함하는 메시지를 만듭니다.

4. **프로세서 로드**:
   - 사전 학습된 모델에서 `AutoProcessor`를 `out_dir` 디렉터리로부터 로드합니다. 이 프로세서는 텍스트와 이미지 입력을 처리합니다.

5. **프롬프트 생성**:
   - `apply_chat_template` 메서드를 사용하여 메시지를 모델에 적합한 프롬프트로 포맷합니다.

6. **입력 처리**:
   - 프롬프트와 이미지를 모델이 이해할 수 있는 텐서로 변환합니다.

7. **생성 인수 설정**:
   - 모델의 생성 과정에 대한 인수를 정의합니다. 여기에는 생성할 새로운 토큰의 최대 수와 출력을 샘플링할지 여부가 포함됩니다.

8. **코드 생성**:
   - 모델이 입력과 생성 인수를 기반으로 Python 코드를 생성합니다. `TextStreamer`는 프롬프트와 특수 토큰을 건너뛰며 출력을 처리합니다.

9. **출력**:
   - 생성된 코드를 출력합니다. 이 코드는 프롬프트에 명시된 대로 이미지를 처리하고 저장하는 Python 코드를 포함해야 합니다.

이 데모는 OpenVino를 사용하여 사전 학습된 모델을 활용해 사용자 입력과 이미지를 기반으로 동적으로 코드를 생성하는 방법을 보여줍니다.

면책 조항: 이 번역은 AI 모델에 의해 원본에서 번역된 것이며 완벽하지 않을 수 있습니다. 
출력을 검토하고 필요한 수정을 해 주시기 바랍니다.